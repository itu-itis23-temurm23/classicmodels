{% extends "layout.html" %}
{% block content %}
<h2>Order #{{ order.orderNumber }}</h2>
<p>
  <strong>Date:</strong> {{ order.orderDate }}  
  |  
  <strong>Status:</strong>
  <span class="badge 
      {% if order.status == 'In Process' %} bg-info 
      {% elif order.status == 'Shipped' %} bg-success
      {% elif order.status == 'Cancelled' %} bg-danger
      {% elif order.status == 'On Hold' %} bg-warning text-dark
      {% else %} bg-secondary
      {% endif %}">
      {{ order.status }}
  </span>
</p>

<hr>

<h4>Items</h4>
<table class="table table-striped">
  <thead>
    <tr><th>Product</th><th>Qty</th><th>Price</th><th>Total</th></tr>
  </thead>
  <tbody>
    {% for it in items %}
    <tr>
      <td>
        <a href="{{ url_for('product_page', product_code=it.productCode) }}">
          {{ it.productName }}
        </a>
      </td>
      <td>{{ it.quantityOrdered }}</td>
      <td>${{ "%.2f"|format(it.priceEach) }}</td>
      <td>${{ "%.2f"|format(it.quantityOrdered * it.priceEach) }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<hr>

{% if session.get('user_type') == 'customer' and order.status == "In Process" %}
<form action="{{ url_for('cancel_order', order_number=order.orderNumber) }}"
      method="POST"
      onsubmit="return confirm('Are you sure you want to cancel this order? This cannot be undone.');">
    <button class="btn btn-danger mt-3">Cancel Order</button>
</form>
{% endif %}

{% endblock %}